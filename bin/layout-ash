#!/bin/bash

show_help_message() {
    cat << END
Usage: layout-ash [OPTIONS]
Switch between specific layout presets

Options:
    -h, --help          show help message
    -n, --normie        for normal user
    -d, --double-ctrl   double ctrl
    -a, --ashket        best keyboard layout
    -t, --toggle        toggle between `ashket` and desired
END
}

use_normie() {
    setxkbmap -option
    setxkbmap \
        -option grp:win_space_toggle \
        -option grp:alt_shift_toggle
    echo "normie" > $LAYOUT_PATH
}

use_ashket() {
    setxkbmap -option
    setxkbmap \
        -option grp:win_space_toggle\
        -option grp:alt_space_toggle \
        # -option caps:escape \
        # -option ctrl:swap_lwin_lctl
    echo "ashket" > $LAYOUT_PATH
}

use_double_control() {
    setxkbmap -option
    setxkbmap \
        -option grp:win_space_toggle\
        -option grp:alt_space_toggle \
        -option caps:escape \
        -option altwin:ctrl_win
    echo "double-control" > $LAYOUT_PATH
}


LAYOUT_PATH="$HOME/bin/temp/layout-ash.txt"
layout=$(cat $LAYOUT_PATH)

if [[ $# == 0 ]]; then
    echo $layout
    exit
fi

if [[ " $@ " =~ ( -h | --help ) ]]; then
    show_help_message
    exit
fi

if [[ $layout != "ashket" && " $@ " =~ ( -t | --toggle ) ]]; then
    use_ashket
    exit
fi

case $1 in
    -n | --normie)
        use_normie;;
    -d | --double-ctrl)
        use_double_control;;
    -a | --ashket | *)
        use_ashket;;
esac
